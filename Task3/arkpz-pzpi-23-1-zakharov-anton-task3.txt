МІНІСТЕРСТВО ОСВІТИ І НАУКИ УКРАЇНИ


ХАРКІВСЬКИЙ НАЦІОНАЛЬНИЙ УНІВЕРСИТЕТ РАДІОЕЛЕКТРОНІКИ

Кафедра «Програмна інженерія»



ЗВІТ
З лаборатоної работи №3 з дисципліни 
«Аналіз та рефакторинг коду»






Виконав:	Перевірив:
ст. гр. ПЗПІ-23-1	ас. кафедри ПІ
Захаров Антон Юрійович	Дашенков Дмитро Сергійович










Харків 2025 

1.	Вступ
1.1.	Тема

Розробка бізнес-логіки та функцій адміністрування серверної частини програмної системи FarmEnviroControl, яка забезпечує моніторинг стану тварин на фермах, автоматичну обробку даних про здоров’я тварин, формування рекомендацій та сповіщень, а також управління користувачами, тваринами, фермами та адміністраторами системи.
1.2.	Мета

Метою лабораторної роботи є створення бізнес-логіки серверної частини та функцій адміністрування, реалізація їх у вигляді програмного коду, перевірка коректності роботи та підготовка демонстрації для оцінки функціональності системи.

2.	Хід роботи
2.1.	Розробка бізнес-логіки
Серверна частина FarmEnviroControl приймає дані про стан здоров’я тварин, що надходять від IoT-пристроїв на фермах. Для кожної тварини система зберігає вид, вік, стан, активність та інші показники. На основі цих даних система формує рекомендації для фермерів, а також генерує сповіщення про критичні зміни. Бізнес-логіка включає алгоритми обробки даних, порівняння з пороговими значеннями та автоматичну генерацію рекомендацій і сповіщень.

2.2.	Розробка функцій адміністрування
Адміністратори системи мають можливість створювати, шкати та видаляти користувачів, тварин, ферми, а також надсилати сповіщення. Адміністрування включає авторизацію адміністратора, управління сесіями, перегляд та модифікацію даних користувачів, тварин, ферм і сповіщень через окрему адмін-панель.

2.3.	Реалізація серверної частини
Для реалізації серверної частини використовуються Node.js, Express та MongoDB з Mongoose. Розроблено маршрути для бізнес-логіки та адміністрування, контролери для обробки даних, генерації сповіщень та рекомендацій, а також інтеграцію з базою даних для зберігання інформації про користувачів, тварин, ферми та сповіщення.

2.4.	Тестування
Тестування серверної частини проводилося за допомогою Postman, ручних сценаріїв та інтегрованої адмін-панелі. Перевірено прийом даних від клієнтів, формування сповіщень при критичних показниках, генерацію рекомендацій та функції адміністрування. Всі операції успішно пройшли тестування.

2.5.	Документування та демонстрація
Розроблено UML-діаграми діяльності та взаємодії серверної частини. Створено відеодемонстрацію роботи бізнес-логіки та функцій адміністрування. Підготовлено хронологічний опис процесу тестування для відео.





3.	Програмна реалізація
3.1.	Бізнес-логіка серверної частини
Серверна частина системи FarmEnviroControl реалізує бізнес-логіку, яка забезпечує автоматичну обробку даних про стан здоров’я тварин, що надходять від IoT-пристроїв на фермах. Для кожної тварини система зберігає вид, вік, стан, активність, а також додаткові параметри. На основі цих даних сервер визначає, чи є стан тварини критичним, і автоматично формує рекомендації для фермерів. У разі небезпечних змін стану здоров’я тварини система генерує сповіщення для відповідальних користувачів.

Фрагмент коду (Node.js, Mongoose):

// ...existing code...
if (animal.state === "bad" && !animal.notified) {
  // Generating recommendations and clarifications
  const rec = recommendations[Math.floor(Math.random() * recommendations.length)];
  const notif = new Notification({
    message,
    farm: animal.farm,
    animal: animal._id,
    recommendation: rec,
    recipients
  });
  await notif.save();
  animal.notified = true;
  await animal.save();
}
// ...existing code...

3.2.	Функції адміністрування серверної частини
Для підтримки ефективної роботи системи реалізовано функції адміністрування, які дозволяють створювати, редагувати та видаляти користувачів, тварин, ферми, а також надсилати сповіщення. Адміністратори мають повний доступ до всіх даних через окрему адмін-панель (admin.html), де реалізовано зручний інтерфейс для керування всіма сутностями.

Фрагмент коду (додавання користувача через адмін-панель):

// ...existing code...
document.getElementById("addUserForm").onsubmit = async (e) => {
  e.preventDefault();
  const fd = new FormData(e.target);
  const payload = Object.fromEntries(fd.entries());
  if (!payload.farmId) delete payload.farmId;
  const res = await fetch(API + "/auth/register", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  });
  // ...existing code...

Фрагмент коду (додавання тварини):
// ...existing code...
document.getElementById("addAnimalForm").onsubmit = async (e) => {
  e.preventDefault();
  const fd = new FormData(e.target);
  const payload = Object.fromEntries(fd.entries());
  payload.animalNumber = Number(payload.animalNumber);
  // state та activity (default)
  const res = await fetch(API + "/animals/add", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(payload)
  });
  // ...existing code...
};
// ...existing code...

Реалізація серверної частини забезпечує інтеграцію з MongoDB через Mongoose, що дозволяє ефективно зберігати інформацію про користувачів, тварин, ферми та сповіщення. Кожен модуль логіки та адміністрування має чіткий інтерфейс для взаємодії з клієнтською частиною системи.


4.	UML-діаграми
4.1.	Розробка АРІ для взаємодії серверної частини з клієнтами 
Розроблено UML-діаграми діяльності та взаємодії серверної частини, які показують процес прийому даних про стан тварин, обробку бізнес-логіки та функції адміністрування. Діаграми демонструють порядок обробки даних, логіку формування рекомендацій і сповіщень, процес додавання та редагування інформації про тварин, а також взаємодію користувача та серверної частини при отриманні сповіщень.



5.	Висновок
Під час виконання лабораторної роботи було успішно розроблено бізнес-логіку серверної частини системи FarmEnviroControl та функції адміністрування користувачів, тварин і ферм. Реалізовано алгоритми обробки даних про стан здоров’я тварин, включно з перевіркою порогових значень, формуванням рекомендацій для фермерів і автоматичною генерацією сповіщень у разі критичних показників. Це забезпечує своєчасне інформування користувачів та оперативне реагування на зміни стану здоров’я тварин.
Функції адміністрування дозволяють адміністраторам системи керувати користувачами, тваринами, фермами та сповіщеннями. Реалізовано механізми створення, редагування та видалення сутностей, що забезпечує безпеку та контроль доступу. Контролери і маршрути для інтеграції бізнес-логіки та адміністрування з MongoDB дозволяють централізовано зберігати та обробляти інформацію про всі сутності системи.
Таким чином, лабораторна робота дозволила закріпити практичні навички розробки серверної частини, застосування Node.js та MongoDB, а також проектування бізнес-логіки та адміністрування користувачів у сучасних IoT-системах для моніторингу тварин.





Додаток А

UML діаграма отримання всіх користувачів

 
Рисунок А.1 – UML отримання всіх користувачів
Діаграма на рис. А.1 описує процес отримання списку користувачів, починаючи від клієнта та закінчуючи поверненням результату з бази даних.




Додаток Б

UML-діаграми активності та взаємодії 
 
Рисунок Б.1 – UML діаграма діяльності: Обробка даних про тварину

Діаграма на рис. Б.1 показує загальний процес обробки даних про тварину: отримання даних із IoT-пристроїв, валідацію, перевірку стану тварини та її дії, формування рекомендацій і сповіщень для користувача.
 
Рисунок Б.2 – UML діаграма діяльності: Створення сповіщення

Діаграма на рис. Б.2 демонструє, як користувач додає нову тварину до системи, а сервер перевіряє дані та зберігає інформацію у базі.

 
 
Рисунок Б.3 – UML діаграма діяльності: Додавання даних здоров’я тварини

Діаграма на рис. Б.3 показує процес додавання даних здоров’я тварини: отримання від пристроїв, перевірка коректності, збереження та створення сповіщень у разі критичних показників.

  
Рисунок Б.4 – UML діаграма Sequence Diagram: Взаємодія користувача та сервера для отримання сповіщень

Діаграма на рис. Б.4 показує, як користувач запитує сповіщення, сервер отримує дані з бази і повертає їх у клієнтську частину.

Посилання на відео: https://youtu.be/rMGfeMyi8uM